<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" targetNamespace="http://activiti.org/bpmn20">
  <process id="vacationRequest" name="Vacation request" isExecutable="true">
    <startEvent id="request" camunda:initiator="employeeName" camunda:initiator="employeeName">
      <extensionElements>
        <camunda:formProperty id="numberOfDays" name="Number of days" type="long" required="true" />
        <camunda:formProperty id="startDate" name="First day of holiday (dd-MM-yyy)" type="date" datePattern="dd-MM-yyyy hh:mm" required="true" />
        <camunda:formProperty id="vacationMotivation" name="Motivation" type="string" />
      </extensionElements>
    </startEvent>
    <sequenceFlow id="flow1" sourceRef="request" targetRef="handleRequest" />
    <userTask id="handleRequest" name="Handle vacation request" camunda:candidateGroups="management">
      <documentation>${employeeName} would like to take ${numberOfDays} day(s) of vacation (Motivation: ${vacationMotivation}).</documentation>
      <extensionElements>
        <camunda:formProperty id="vacationApproved" name="Do you approve this vacation" type="enum" required="true">
          <camunda:value id="true" name="Approve" />
          <camunda:value id="false" name="Reject" />
        </camunda:formProperty>
        <camunda:formProperty id="managerMotivation" name="Motivation" type="string" />
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow2" sourceRef="handleRequest" targetRef="requestApprovedDecision" />
    <exclusiveGateway id="requestApprovedDecision" name="Request approved?" />
    <sequenceFlow id="flow3" sourceRef="requestApprovedDecision" targetRef="sendApprovalMail">
      <conditionExpression xsi:type="tFormalExpression">${vacationApproved == 'true'}</conditionExpression>
    </sequenceFlow>
    <manualTask id="sendApprovalMail" name="Send confirmation e-mail" />
    <sequenceFlow id="flow4" sourceRef="sendApprovalMail" targetRef="theEnd1" />
    <endEvent id="theEnd1" />
    <sequenceFlow id="flow5" sourceRef="requestApprovedDecision" targetRef="adjustVacationRequestTask">
      <conditionExpression xsi:type="tFormalExpression">${vacationApproved == 'false'}</conditionExpression>
    </sequenceFlow>
    <userTask id="adjustVacationRequestTask" name="Adjust vacation request" camunda:assignee="${employeeName}">
      <documentation>Your manager has disapproved your vacation request for ${numberOfDays} days.
        Reason: ${managerMotivation}</documentation>
      <extensionElements>
        <camunda:formProperty id="numberOfDays" name="Number of days" type="long" required="true" />
        <camunda:formProperty id="startDate" name="First day of holiday (dd-MM-yyy)" type="date" datePattern="dd-MM-yyyy hh:mm" required="true" />
        <camunda:formProperty id="vacationMotivation" name="Motivation" type="string" />
        <camunda:formProperty id="resendRequest" name="Resend vacation request to manager?" type="enum" required="true">
          <camunda:value id="true" name="Yes" />
          <camunda:value id="false" name="No" />
        </camunda:formProperty>
        <modeler:initiator-can-complete xmlns:modeler="http://activiti.com/modeler">false</modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow6" sourceRef="adjustVacationRequestTask" targetRef="resendRequestDecision" />
    <exclusiveGateway id="resendRequestDecision" name="&#39;Resend request?&#39;" />
    <sequenceFlow id="flow8" sourceRef="resendRequestDecision" targetRef="theEnd2">
      <conditionExpression xsi:type="tFormalExpression">${resendRequest == 'false'}</conditionExpression>
    </sequenceFlow>
    <endEvent id="theEnd2" />
    <sequenceFlow id="flow7" sourceRef="resendRequestDecision" targetRef="handleRequest">
      <conditionExpression xsi:type="tFormalExpression">${resendRequest == 'true'}</conditionExpression>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_vacationRequest">
    <bpmndi:BPMNPlane id="BPMNPlane_vacationRequest" bpmnElement="vacationRequest">
      <bpmndi:BPMNShape id="BPMNShape_request" bpmnElement="request">
        <omgdc:Bounds x="0" y="178" width="30" height="30" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_handleRequest" bpmnElement="handleRequest">
        <omgdc:Bounds x="80" y="163" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_requestApprovedDecision" bpmnElement="requestApprovedDecision" isMarkerVisible="true">
        <omgdc:Bounds x="230" y="114" width="40" height="40" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="225" y="154" width="52" height="24" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_sendApprovalMail" bpmnElement="sendApprovalMail">
        <omgdc:Bounds x="320" y="0" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_theEnd1" bpmnElement="theEnd1">
        <omgdc:Bounds x="475" y="15" width="28" height="28" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_adjustVacationRequestTask" bpmnElement="adjustVacationRequestTask">
        <omgdc:Bounds x="435" y="120" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_resendRequestDecision" bpmnElement="resendRequestDecision" isMarkerVisible="true">
        <omgdc:Bounds x="270" y="270" width="40" height="40" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="246" y="310" width="88" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_theEnd2" bpmnElement="theEnd2">
        <omgdc:Bounds x="471" y="330" width="28" height="28" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_flow1" bpmnElement="flow1">
        <omgdi:waypoint x="30" y="193" />
        <omgdi:waypoint x="80" y="193" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="10" y="168" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow2" bpmnElement="flow2">
        <omgdi:waypoint x="180" y="193" />
        <omgdi:waypoint x="205" y="193" />
        <omgdi:waypoint x="205" y="134" />
        <omgdi:waypoint x="230" y="134" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="175" y="153.5" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow3" bpmnElement="flow3">
        <omgdi:waypoint x="270" y="134" />
        <omgdi:waypoint x="282" y="134" />
        <omgdi:waypoint x="282" y="30.000000000000007" />
        <omgdi:waypoint x="320" y="30" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow4" bpmnElement="flow4">
        <omgdi:waypoint x="420" y="30" />
        <omgdi:waypoint x="432" y="30" />
        <omgdi:waypoint x="432" y="30" />
        <omgdi:waypoint x="475.00215401185983" y="29.24557624540596" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow5" bpmnElement="flow5">
        <omgdi:waypoint x="270" y="134" />
        <omgdi:waypoint x="282" y="134" />
        <omgdi:waypoint x="282" y="150" />
        <omgdi:waypoint x="435" y="150" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow6" bpmnElement="flow6">
        <omgdi:waypoint x="485" y="180" />
        <omgdi:waypoint x="485" y="206.5" />
        <omgdi:waypoint x="290" y="206.5" />
        <omgdi:waypoint x="290" y="270" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow7" bpmnElement="flow7">
        <omgdi:waypoint x="270" y="290" />
        <omgdi:waypoint x="130" y="286" />
        <omgdi:waypoint x="130" y="223" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="155" y="263" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow8" bpmnElement="flow8">
        <omgdi:waypoint x="310" y="290" />
        <omgdi:waypoint x="485" y="290" />
        <omgdi:waypoint x="485" y="330" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
